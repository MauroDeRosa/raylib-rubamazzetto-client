\hypertarget{utringbuffer_8h_source}{}\doxysection{utringbuffer.\+h}
\label{utringbuffer_8h_source}\index{include/external/uthash/utringbuffer.h@{include/external/uthash/utringbuffer.h}}
\mbox{\hyperlink{utringbuffer_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{Copyright (c) 2015-\/2022, Troy D. Hanson  https://troydhanson.github.io/uthash/}}
\DoxyCodeLine{3 \textcolor{comment}{All rights reserved.}}
\DoxyCodeLine{4 \textcolor{comment}{}}
\DoxyCodeLine{5 \textcolor{comment}{Redistribution and use in source and binary forms, with or without}}
\DoxyCodeLine{6 \textcolor{comment}{modification, are permitted provided that the following conditions are met:}}
\DoxyCodeLine{7 \textcolor{comment}{}}
\DoxyCodeLine{8 \textcolor{comment}{    * Redistributions of source code must retain the above copyright}}
\DoxyCodeLine{9 \textcolor{comment}{      notice, this list of conditions and the following disclaimer.}}
\DoxyCodeLine{10 \textcolor{comment}{}}
\DoxyCodeLine{11 \textcolor{comment}{THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "{}AS}}
\DoxyCodeLine{12 \textcolor{comment}{IS"{} AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED}}
\DoxyCodeLine{13 \textcolor{comment}{TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A}}
\DoxyCodeLine{14 \textcolor{comment}{PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER}}
\DoxyCodeLine{15 \textcolor{comment}{OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,}}
\DoxyCodeLine{16 \textcolor{comment}{EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,}}
\DoxyCodeLine{17 \textcolor{comment}{PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR}}
\DoxyCodeLine{18 \textcolor{comment}{PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF}}
\DoxyCodeLine{19 \textcolor{comment}{LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING}}
\DoxyCodeLine{20 \textcolor{comment}{NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS}}
\DoxyCodeLine{21 \textcolor{comment}{SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.}}
\DoxyCodeLine{22 \textcolor{comment}{*/}}
\DoxyCodeLine{23 }
\DoxyCodeLine{24 \textcolor{comment}{/* a ring-\/buffer implementation using macros}}
\DoxyCodeLine{25 \textcolor{comment}{ */}}
\DoxyCodeLine{26 \textcolor{preprocessor}{\#ifndef UTRINGBUFFER\_H}}
\DoxyCodeLine{27 \textcolor{preprocessor}{\#define UTRINGBUFFER\_H}}
\DoxyCodeLine{28 }
\DoxyCodeLine{29 \textcolor{preprocessor}{\#define UTRINGBUFFER\_VERSION 2.3.0}}
\DoxyCodeLine{30 }
\DoxyCodeLine{31 \textcolor{preprocessor}{\#include <stdlib.h>}}
\DoxyCodeLine{32 \textcolor{preprocessor}{\#include <string.h>}}
\DoxyCodeLine{33 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{utarray_8h}{utarray.h}}"{}}  \textcolor{comment}{// for "{}UT\_icd"{}}}
\DoxyCodeLine{34 }
\DoxyCodeLine{35 \textcolor{keyword}{typedef} \textcolor{keyword}{struct }\{}
\DoxyCodeLine{36     \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{structUT__ringbuffer_a6708be920ab5135cc4b06694a17dd3bc}{i}};       \textcolor{comment}{/* index of next available slot; wraps at n */}}
\DoxyCodeLine{37     \textcolor{keywordtype}{unsigned} \mbox{\hyperlink{structUT__ringbuffer_a96e99a1747c8a882ba10bebd038d9503}{n}};       \textcolor{comment}{/* capacity */}}
\DoxyCodeLine{38     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} \mbox{\hyperlink{structUT__ringbuffer_af1c3dd3268f90808f9a4b43fdcf2378d}{f}};  \textcolor{comment}{/* full */}}
\DoxyCodeLine{39     \mbox{\hyperlink{structUT__icd}{UT\_icd}} \mbox{\hyperlink{structUT__ringbuffer_a58d090271a003e683d40c6e05e1906f6}{icd}};       \textcolor{comment}{/* initializer, copy and destructor functions */}}
\DoxyCodeLine{40     \textcolor{keywordtype}{char} *\mbox{\hyperlink{structUT__ringbuffer_a28975314fd3873ed6ca86e4658f6c759}{d}};          \textcolor{comment}{/* n slots of size icd-\/>sz */}}
\DoxyCodeLine{41 \} \mbox{\hyperlink{structUT__ringbuffer}{UT\_ringbuffer}};}
\DoxyCodeLine{42 }
\DoxyCodeLine{43 \textcolor{preprocessor}{\#define utringbuffer\_init(a, \_n, \_icd) do \{                               \(\backslash\)}}
\DoxyCodeLine{44 \textcolor{preprocessor}{  memset(a, 0, sizeof(UT\_ringbuffer));                                    \(\backslash\)}}
\DoxyCodeLine{45 \textcolor{preprocessor}{  (a)-\/>icd = *(\_icd);                                                     \(\backslash\)}}
\DoxyCodeLine{46 \textcolor{preprocessor}{  (a)-\/>n = (\_n);                                                          \(\backslash\)}}
\DoxyCodeLine{47 \textcolor{preprocessor}{  if ((a)-\/>n) \{ (a)-\/>d = (char*)malloc((a)-\/>n * (\_icd)-\/>sz); \}            \(\backslash\)}}
\DoxyCodeLine{48 \textcolor{preprocessor}{\} while(0)}}
\DoxyCodeLine{49 }
\DoxyCodeLine{50 \textcolor{preprocessor}{\#define utringbuffer\_clear(a) do \{                                        \(\backslash\)}}
\DoxyCodeLine{51 \textcolor{preprocessor}{  if ((a)-\/>icd.dtor) \{                                                    \(\backslash\)}}
\DoxyCodeLine{52 \textcolor{preprocessor}{    if ((a)-\/>f) \{                                                         \(\backslash\)}}
\DoxyCodeLine{53 \textcolor{preprocessor}{      unsigned \_ut\_i;                                                     \(\backslash\)}}
\DoxyCodeLine{54 \textcolor{preprocessor}{      for (\_ut\_i = 0; \_ut\_i < (a)-\/>n; ++\_ut\_i) \{                          \(\backslash\)}}
\DoxyCodeLine{55 \textcolor{preprocessor}{        (a)-\/>icd.dtor(utringbuffer\_eltptr(a, \_ut\_i));                     \(\backslash\)}}
\DoxyCodeLine{56 \textcolor{preprocessor}{      \}                                                                   \(\backslash\)}}
\DoxyCodeLine{57 \textcolor{preprocessor}{    \} else \{                                                              \(\backslash\)}}
\DoxyCodeLine{58 \textcolor{preprocessor}{      unsigned \_ut\_i;                                                     \(\backslash\)}}
\DoxyCodeLine{59 \textcolor{preprocessor}{      for (\_ut\_i = 0; \_ut\_i < (a)-\/>i; ++\_ut\_i) \{                          \(\backslash\)}}
\DoxyCodeLine{60 \textcolor{preprocessor}{        (a)-\/>icd.dtor(utringbuffer\_eltptr(a, \_ut\_i));                     \(\backslash\)}}
\DoxyCodeLine{61 \textcolor{preprocessor}{      \}                                                                   \(\backslash\)}}
\DoxyCodeLine{62 \textcolor{preprocessor}{    \}                                                                     \(\backslash\)}}
\DoxyCodeLine{63 \textcolor{preprocessor}{  \}                                                                       \(\backslash\)}}
\DoxyCodeLine{64 \textcolor{preprocessor}{  (a)-\/>i = 0;                                                             \(\backslash\)}}
\DoxyCodeLine{65 \textcolor{preprocessor}{  (a)-\/>f = 0;                                                             \(\backslash\)}}
\DoxyCodeLine{66 \textcolor{preprocessor}{\} while(0)}}
\DoxyCodeLine{67 }
\DoxyCodeLine{68 \textcolor{preprocessor}{\#define utringbuffer\_done(a) do \{                                         \(\backslash\)}}
\DoxyCodeLine{69 \textcolor{preprocessor}{  utringbuffer\_clear(a);                                                  \(\backslash\)}}
\DoxyCodeLine{70 \textcolor{preprocessor}{  free((a)-\/>d); (a)-\/>d = NULL;                                            \(\backslash\)}}
\DoxyCodeLine{71 \textcolor{preprocessor}{  (a)-\/>n = 0;                                                             \(\backslash\)}}
\DoxyCodeLine{72 \textcolor{preprocessor}{\} while(0)}}
\DoxyCodeLine{73 }
\DoxyCodeLine{74 \textcolor{preprocessor}{\#define utringbuffer\_new(a,n,\_icd) do \{                                   \(\backslash\)}}
\DoxyCodeLine{75 \textcolor{preprocessor}{  a = (UT\_ringbuffer*)malloc(sizeof(UT\_ringbuffer));                      \(\backslash\)}}
\DoxyCodeLine{76 \textcolor{preprocessor}{  utringbuffer\_init(a, n, \_icd);                                          \(\backslash\)}}
\DoxyCodeLine{77 \textcolor{preprocessor}{\} while(0)}}
\DoxyCodeLine{78 }
\DoxyCodeLine{79 \textcolor{preprocessor}{\#define utringbuffer\_free(a) do \{                                         \(\backslash\)}}
\DoxyCodeLine{80 \textcolor{preprocessor}{  utringbuffer\_done(a);                                                   \(\backslash\)}}
\DoxyCodeLine{81 \textcolor{preprocessor}{  free(a);                                                                \(\backslash\)}}
\DoxyCodeLine{82 \textcolor{preprocessor}{\} while(0)}}
\DoxyCodeLine{83 }
\DoxyCodeLine{84 \textcolor{preprocessor}{\#define utringbuffer\_push\_back(a,p) do \{                                                \(\backslash\)}}
\DoxyCodeLine{85 \textcolor{preprocessor}{  if ((a)-\/>icd.dtor \&\& (a)-\/>f) \{ (a)-\/>icd.dtor(\_utringbuffer\_internalptr(a,(a)-\/>i)); \}  \(\backslash\)}}
\DoxyCodeLine{86 \textcolor{preprocessor}{  if ((a)-\/>icd.copy) \{ (a)-\/>icd.copy( \_utringbuffer\_internalptr(a,(a)-\/>i), p); \}        \(\backslash\)}}
\DoxyCodeLine{87 \textcolor{preprocessor}{  else \{ memcpy(\_utringbuffer\_internalptr(a,(a)-\/>i), p, (a)-\/>icd.sz); \};                \(\backslash\)}}
\DoxyCodeLine{88 \textcolor{preprocessor}{  if (++(a)-\/>i == (a)-\/>n) \{ (a)-\/>i = 0; (a)-\/>f = 1; \}                                   \(\backslash\)}}
\DoxyCodeLine{89 \textcolor{preprocessor}{\} while(0)}}
\DoxyCodeLine{90 }
\DoxyCodeLine{91 \textcolor{preprocessor}{\#define utringbuffer\_len(a) ((a)-\/>f ? (a)-\/>n : (a)-\/>i)}}
\DoxyCodeLine{92 \textcolor{preprocessor}{\#define utringbuffer\_empty(a) ((a)-\/>i == 0 \&\& !(a)-\/>f)}}
\DoxyCodeLine{93 \textcolor{preprocessor}{\#define utringbuffer\_full(a) ((a)-\/>f != 0)}}
\DoxyCodeLine{94 }
\DoxyCodeLine{95 \textcolor{preprocessor}{\#define \_utringbuffer\_real\_idx(a,j) ((a)-\/>f ? ((j) + (a)-\/>i) \% (a)-\/>n : (j))}}
\DoxyCodeLine{96 \textcolor{preprocessor}{\#define \_utringbuffer\_internalptr(a,j) ((void*)((a)-\/>d + ((a)-\/>icd.sz * (j))))}}
\DoxyCodeLine{97 \textcolor{preprocessor}{\#define utringbuffer\_eltptr(a,j) ((0 <= (j) \&\& (j) < utringbuffer\_len(a)) ? \_utringbuffer\_internalptr(a,\_utringbuffer\_real\_idx(a,j)) : NULL)}}
\DoxyCodeLine{98 }
\DoxyCodeLine{99 \textcolor{preprocessor}{\#define \_utringbuffer\_fake\_idx(a,j) ((a)-\/>f ? ((j) + (a)-\/>n -\/ (a)-\/>i) \% (a)-\/>n : (j))}}
\DoxyCodeLine{100 \textcolor{preprocessor}{\#define \_utringbuffer\_internalidx(a,e) (((char*)(e) >= (a)-\/>d) ? (((char*)(e) -\/ (a)-\/>d)/(a)-\/>icd.sz) : -\/1)}}
\DoxyCodeLine{101 \textcolor{preprocessor}{\#define utringbuffer\_eltidx(a,e) \_utringbuffer\_fake\_idx(a, \_utringbuffer\_internalidx(a,e))}}
\DoxyCodeLine{102 }
\DoxyCodeLine{103 \textcolor{preprocessor}{\#define utringbuffer\_front(a) utringbuffer\_eltptr(a,0)}}
\DoxyCodeLine{104 \textcolor{preprocessor}{\#define utringbuffer\_next(a,e) ((e)==NULL ? utringbuffer\_front(a) : utringbuffer\_eltptr(a, utringbuffer\_eltidx(a,e)+1))}}
\DoxyCodeLine{105 \textcolor{preprocessor}{\#define utringbuffer\_prev(a,e) ((e)==NULL ? utringbuffer\_back(a) : utringbuffer\_eltptr(a, utringbuffer\_eltidx(a,e)-\/1))}}
\DoxyCodeLine{106 \textcolor{preprocessor}{\#define utringbuffer\_back(a) (utringbuffer\_empty(a) ? NULL : utringbuffer\_eltptr(a, utringbuffer\_len(a) -\/ 1))}}
\DoxyCodeLine{107 }
\DoxyCodeLine{108 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* UTRINGBUFFER\_H */}\textcolor{preprocessor}{}}

\end{DoxyCode}
