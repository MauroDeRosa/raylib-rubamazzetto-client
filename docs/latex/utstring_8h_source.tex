\hypertarget{utstring_8h_source}{}\doxysection{utstring.\+h}
\label{utstring_8h_source}\index{include/external/uthash/utstring.h@{include/external/uthash/utstring.h}}
\mbox{\hyperlink{utstring_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/*}}
\DoxyCodeLine{2 \textcolor{comment}{Copyright (c) 2008-\/2022, Troy D. Hanson  https://troydhanson.github.io/uthash/}}
\DoxyCodeLine{3 \textcolor{comment}{All rights reserved.}}
\DoxyCodeLine{4 \textcolor{comment}{}}
\DoxyCodeLine{5 \textcolor{comment}{Redistribution and use in source and binary forms, with or without}}
\DoxyCodeLine{6 \textcolor{comment}{modification, are permitted provided that the following conditions are met:}}
\DoxyCodeLine{7 \textcolor{comment}{}}
\DoxyCodeLine{8 \textcolor{comment}{    * Redistributions of source code must retain the above copyright}}
\DoxyCodeLine{9 \textcolor{comment}{      notice, this list of conditions and the following disclaimer.}}
\DoxyCodeLine{10 \textcolor{comment}{}}
\DoxyCodeLine{11 \textcolor{comment}{THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "{}AS}}
\DoxyCodeLine{12 \textcolor{comment}{IS"{} AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED}}
\DoxyCodeLine{13 \textcolor{comment}{TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A}}
\DoxyCodeLine{14 \textcolor{comment}{PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER}}
\DoxyCodeLine{15 \textcolor{comment}{OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,}}
\DoxyCodeLine{16 \textcolor{comment}{EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,}}
\DoxyCodeLine{17 \textcolor{comment}{PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR}}
\DoxyCodeLine{18 \textcolor{comment}{PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF}}
\DoxyCodeLine{19 \textcolor{comment}{LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING}}
\DoxyCodeLine{20 \textcolor{comment}{NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS}}
\DoxyCodeLine{21 \textcolor{comment}{SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.}}
\DoxyCodeLine{22 \textcolor{comment}{*/}}
\DoxyCodeLine{23 }
\DoxyCodeLine{24 \textcolor{comment}{/* a dynamic string implementation using macros}}
\DoxyCodeLine{25 \textcolor{comment}{ */}}
\DoxyCodeLine{26 \textcolor{preprocessor}{\#ifndef UTSTRING\_H}}
\DoxyCodeLine{27 \textcolor{preprocessor}{\#define UTSTRING\_H}}
\DoxyCodeLine{28 }
\DoxyCodeLine{29 \textcolor{preprocessor}{\#define UTSTRING\_VERSION 2.3.0}}
\DoxyCodeLine{30 }
\DoxyCodeLine{31 \textcolor{preprocessor}{\#include <stdlib.h>}}
\DoxyCodeLine{32 \textcolor{preprocessor}{\#include <string.h>}}
\DoxyCodeLine{33 \textcolor{preprocessor}{\#include <stdio.h>}}
\DoxyCodeLine{34 \textcolor{preprocessor}{\#include <stdarg.h>}}
\DoxyCodeLine{35 }
\DoxyCodeLine{36 \textcolor{preprocessor}{\#ifdef \_\_GNUC\_\_}}
\DoxyCodeLine{37 \textcolor{preprocessor}{\#define UTSTRING\_UNUSED \_\_attribute\_\_((\_\_unused\_\_))}}
\DoxyCodeLine{38 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{39 \textcolor{preprocessor}{\#define UTSTRING\_UNUSED}}
\DoxyCodeLine{40 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{41 }
\DoxyCodeLine{42 \textcolor{preprocessor}{\#ifdef oom}}
\DoxyCodeLine{43 \textcolor{preprocessor}{\#error "{}The name of macro 'oom' has been changed to 'utstring\_oom'. Please update your code."{}}}
\DoxyCodeLine{44 \textcolor{preprocessor}{\#define utstring\_oom() oom()}}
\DoxyCodeLine{45 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{46 }
\DoxyCodeLine{47 \textcolor{preprocessor}{\#ifndef utstring\_oom}}
\DoxyCodeLine{48 \textcolor{preprocessor}{\#define utstring\_oom() exit(-\/1)}}
\DoxyCodeLine{49 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{50 }
\DoxyCodeLine{51 \textcolor{keyword}{typedef} \textcolor{keyword}{struct }\{}
\DoxyCodeLine{52     \textcolor{keywordtype}{char} *\mbox{\hyperlink{structUT__string_ae8062f7fa4067676e9d74ca2b2923ff9}{d}};  \textcolor{comment}{/* pointer to allocated buffer */}}
\DoxyCodeLine{53     \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{structUT__string_a85161591fe87dd4be9cc031e282ffc1f}{n}}; \textcolor{comment}{/* allocated capacity */}}
\DoxyCodeLine{54     \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{structUT__string_aa78df8b7c6db840e406431e5cb8941be}{i}}; \textcolor{comment}{/* index of first unused byte */}}
\DoxyCodeLine{55 \} \mbox{\hyperlink{structUT__string}{UT\_string}};}
\DoxyCodeLine{56 }
\DoxyCodeLine{57 \textcolor{preprocessor}{\#define utstring\_reserve(s,amt)                            \(\backslash\)}}
\DoxyCodeLine{58 \textcolor{preprocessor}{do \{                                                       \(\backslash\)}}
\DoxyCodeLine{59 \textcolor{preprocessor}{  if (((s)-\/>n -\/ (s)-\/>i) < (size\_t)(amt)) \{                 \(\backslash\)}}
\DoxyCodeLine{60 \textcolor{preprocessor}{    char *utstring\_tmp = (char*)realloc(                   \(\backslash\)}}
\DoxyCodeLine{61 \textcolor{preprocessor}{      (s)-\/>d, (s)-\/>n + (amt));                             \(\backslash\)}}
\DoxyCodeLine{62 \textcolor{preprocessor}{    if (!utstring\_tmp) \{                                   \(\backslash\)}}
\DoxyCodeLine{63 \textcolor{preprocessor}{      utstring\_oom();                                      \(\backslash\)}}
\DoxyCodeLine{64 \textcolor{preprocessor}{    \}                                                      \(\backslash\)}}
\DoxyCodeLine{65 \textcolor{preprocessor}{    (s)-\/>d = utstring\_tmp;                                 \(\backslash\)}}
\DoxyCodeLine{66 \textcolor{preprocessor}{    (s)-\/>n += (amt);                                       \(\backslash\)}}
\DoxyCodeLine{67 \textcolor{preprocessor}{  \}                                                        \(\backslash\)}}
\DoxyCodeLine{68 \textcolor{preprocessor}{\} while(0)}}
\DoxyCodeLine{69 }
\DoxyCodeLine{70 \textcolor{preprocessor}{\#define utstring\_init(s)                                   \(\backslash\)}}
\DoxyCodeLine{71 \textcolor{preprocessor}{do \{                                                       \(\backslash\)}}
\DoxyCodeLine{72 \textcolor{preprocessor}{  (s)-\/>n = 0; (s)-\/>i = 0; (s)-\/>d = NULL;                   \(\backslash\)}}
\DoxyCodeLine{73 \textcolor{preprocessor}{  utstring\_reserve(s,100);                                 \(\backslash\)}}
\DoxyCodeLine{74 \textcolor{preprocessor}{  (s)-\/>d[0] = '\(\backslash\)0';                                        \(\backslash\)}}
\DoxyCodeLine{75 \textcolor{preprocessor}{\} while(0)}}
\DoxyCodeLine{76 }
\DoxyCodeLine{77 \textcolor{preprocessor}{\#define utstring\_done(s)                                   \(\backslash\)}}
\DoxyCodeLine{78 \textcolor{preprocessor}{do \{                                                       \(\backslash\)}}
\DoxyCodeLine{79 \textcolor{preprocessor}{  if ((s)-\/>d != NULL) free((s)-\/>d);                        \(\backslash\)}}
\DoxyCodeLine{80 \textcolor{preprocessor}{  (s)-\/>n = 0;                                              \(\backslash\)}}
\DoxyCodeLine{81 \textcolor{preprocessor}{\} while(0)}}
\DoxyCodeLine{82 }
\DoxyCodeLine{83 \textcolor{preprocessor}{\#define utstring\_free(s)                                   \(\backslash\)}}
\DoxyCodeLine{84 \textcolor{preprocessor}{do \{                                                       \(\backslash\)}}
\DoxyCodeLine{85 \textcolor{preprocessor}{  utstring\_done(s);                                        \(\backslash\)}}
\DoxyCodeLine{86 \textcolor{preprocessor}{  free(s);                                                 \(\backslash\)}}
\DoxyCodeLine{87 \textcolor{preprocessor}{\} while(0)}}
\DoxyCodeLine{88 }
\DoxyCodeLine{89 \textcolor{preprocessor}{\#define utstring\_new(s)                                    \(\backslash\)}}
\DoxyCodeLine{90 \textcolor{preprocessor}{do \{                                                       \(\backslash\)}}
\DoxyCodeLine{91 \textcolor{preprocessor}{  (s) = (UT\_string*)malloc(sizeof(UT\_string));             \(\backslash\)}}
\DoxyCodeLine{92 \textcolor{preprocessor}{  if (!(s)) \{                                              \(\backslash\)}}
\DoxyCodeLine{93 \textcolor{preprocessor}{    utstring\_oom();                                        \(\backslash\)}}
\DoxyCodeLine{94 \textcolor{preprocessor}{  \}                                                        \(\backslash\)}}
\DoxyCodeLine{95 \textcolor{preprocessor}{  utstring\_init(s);                                        \(\backslash\)}}
\DoxyCodeLine{96 \textcolor{preprocessor}{\} while(0)}}
\DoxyCodeLine{97 }
\DoxyCodeLine{98 \textcolor{preprocessor}{\#define utstring\_renew(s)                                  \(\backslash\)}}
\DoxyCodeLine{99 \textcolor{preprocessor}{do \{                                                       \(\backslash\)}}
\DoxyCodeLine{100 \textcolor{preprocessor}{   if (s) \{                                                \(\backslash\)}}
\DoxyCodeLine{101 \textcolor{preprocessor}{     utstring\_clear(s);                                    \(\backslash\)}}
\DoxyCodeLine{102 \textcolor{preprocessor}{   \} else \{                                                \(\backslash\)}}
\DoxyCodeLine{103 \textcolor{preprocessor}{     utstring\_new(s);                                      \(\backslash\)}}
\DoxyCodeLine{104 \textcolor{preprocessor}{   \}                                                       \(\backslash\)}}
\DoxyCodeLine{105 \textcolor{preprocessor}{\} while(0)}}
\DoxyCodeLine{106 }
\DoxyCodeLine{107 \textcolor{preprocessor}{\#define utstring\_clear(s)                                  \(\backslash\)}}
\DoxyCodeLine{108 \textcolor{preprocessor}{do \{                                                       \(\backslash\)}}
\DoxyCodeLine{109 \textcolor{preprocessor}{  (s)-\/>i = 0;                                              \(\backslash\)}}
\DoxyCodeLine{110 \textcolor{preprocessor}{  (s)-\/>d[0] = '\(\backslash\)0';                                        \(\backslash\)}}
\DoxyCodeLine{111 \textcolor{preprocessor}{\} while(0)}}
\DoxyCodeLine{112 }
\DoxyCodeLine{113 \textcolor{preprocessor}{\#define utstring\_bincpy(s,b,l)                             \(\backslash\)}}
\DoxyCodeLine{114 \textcolor{preprocessor}{do \{                                                       \(\backslash\)}}
\DoxyCodeLine{115 \textcolor{preprocessor}{  utstring\_reserve((s),(l)+1);                             \(\backslash\)}}
\DoxyCodeLine{116 \textcolor{preprocessor}{  if (l) memcpy(\&(s)-\/>d[(s)-\/>i], b, l);                    \(\backslash\)}}
\DoxyCodeLine{117 \textcolor{preprocessor}{  (s)-\/>i += (l);                                           \(\backslash\)}}
\DoxyCodeLine{118 \textcolor{preprocessor}{  (s)-\/>d[(s)-\/>i]='\(\backslash\)0';                                     \(\backslash\)}}
\DoxyCodeLine{119 \textcolor{preprocessor}{\} while(0)}}
\DoxyCodeLine{120 }
\DoxyCodeLine{121 \textcolor{preprocessor}{\#define utstring\_concat(dst,src)                                 \(\backslash\)}}
\DoxyCodeLine{122 \textcolor{preprocessor}{do \{                                                             \(\backslash\)}}
\DoxyCodeLine{123 \textcolor{preprocessor}{  utstring\_reserve((dst),((src)-\/>i)+1);                          \(\backslash\)}}
\DoxyCodeLine{124 \textcolor{preprocessor}{  if ((src)-\/>i) memcpy(\&(dst)-\/>d[(dst)-\/>i], (src)-\/>d, (src)-\/>i); \(\backslash\)}}
\DoxyCodeLine{125 \textcolor{preprocessor}{  (dst)-\/>i += (src)-\/>i;                                          \(\backslash\)}}
\DoxyCodeLine{126 \textcolor{preprocessor}{  (dst)-\/>d[(dst)-\/>i]='\(\backslash\)0';                                       \(\backslash\)}}
\DoxyCodeLine{127 \textcolor{preprocessor}{\} while(0)}}
\DoxyCodeLine{128 }
\DoxyCodeLine{129 \textcolor{preprocessor}{\#define utstring\_len(s) ((s)-\/>i)}}
\DoxyCodeLine{130 }
\DoxyCodeLine{131 \textcolor{preprocessor}{\#define utstring\_body(s) ((s)-\/>d)}}
\DoxyCodeLine{132 }
\DoxyCodeLine{133 \mbox{\hyperlink{utstring_8h_a79ab83e6c427f21551500567eb5f143e}{UTSTRING\_UNUSED}} \textcolor{keyword}{static} \textcolor{keywordtype}{void} utstring\_printf\_va(\mbox{\hyperlink{structUT__string}{UT\_string}} *s, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *fmt, va\_list ap) \{}
\DoxyCodeLine{134    \textcolor{keywordtype}{int} n;}
\DoxyCodeLine{135    va\_list cp;}
\DoxyCodeLine{136    \textcolor{keywordflow}{for} (;;) \{}
\DoxyCodeLine{137 \textcolor{preprocessor}{\#ifdef \_WIN32}}
\DoxyCodeLine{138       cp = ap;}
\DoxyCodeLine{139 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{140       va\_copy(cp, ap);}
\DoxyCodeLine{141 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{142       n = vsnprintf (\&s-\/>\mbox{\hyperlink{structUT__string_ae8062f7fa4067676e9d74ca2b2923ff9}{d}}[s-\/>\mbox{\hyperlink{structUT__string_aa78df8b7c6db840e406431e5cb8941be}{i}}], s-\/>\mbox{\hyperlink{structUT__string_a85161591fe87dd4be9cc031e282ffc1f}{n}}-\/s-\/>\mbox{\hyperlink{structUT__string_aa78df8b7c6db840e406431e5cb8941be}{i}}, fmt, cp);}
\DoxyCodeLine{143       va\_end(cp);}
\DoxyCodeLine{144 }
\DoxyCodeLine{145       \textcolor{keywordflow}{if} ((n > -\/1) \&\& ((\textcolor{keywordtype}{size\_t}) n < (s-\/>\mbox{\hyperlink{structUT__string_a85161591fe87dd4be9cc031e282ffc1f}{n}}-\/s-\/>\mbox{\hyperlink{structUT__string_aa78df8b7c6db840e406431e5cb8941be}{i}}))) \{}
\DoxyCodeLine{146         s-\/>\mbox{\hyperlink{structUT__string_aa78df8b7c6db840e406431e5cb8941be}{i}} += n;}
\DoxyCodeLine{147         \textcolor{keywordflow}{return};}
\DoxyCodeLine{148       \}}
\DoxyCodeLine{149 }
\DoxyCodeLine{150       \textcolor{comment}{/* Else try again with more space. */}}
\DoxyCodeLine{151       \textcolor{keywordflow}{if} (n > -\/1) \mbox{\hyperlink{utstring_8h_a5448b6675f3e1eb9d0f8fce6f9b3987c}{utstring\_reserve}}(s,n+1); \textcolor{comment}{/* exact */}}
\DoxyCodeLine{152       \textcolor{keywordflow}{else} \mbox{\hyperlink{utstring_8h_a5448b6675f3e1eb9d0f8fce6f9b3987c}{utstring\_reserve}}(s,(s-\/>\mbox{\hyperlink{structUT__string_a85161591fe87dd4be9cc031e282ffc1f}{n}})*2);   \textcolor{comment}{/* 2x */}}
\DoxyCodeLine{153    \}}
\DoxyCodeLine{154 \}}
\DoxyCodeLine{155 \textcolor{preprocessor}{\#ifdef \_\_GNUC\_\_}}
\DoxyCodeLine{156 \textcolor{comment}{/* support printf format checking (2=the format string, 3=start of varargs) */}}
\DoxyCodeLine{157 \textcolor{keyword}{static} \textcolor{keywordtype}{void} utstring\_printf(\mbox{\hyperlink{structUT__string}{UT\_string}} *s, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *fmt, ...)}
\DoxyCodeLine{158   \_\_attribute\_\_ (( format( printf, 2, 3) ));}
\DoxyCodeLine{159 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{160 \mbox{\hyperlink{utstring_8h_a79ab83e6c427f21551500567eb5f143e}{UTSTRING\_UNUSED}} \textcolor{keyword}{static} \textcolor{keywordtype}{void} utstring\_printf(\mbox{\hyperlink{structUT__string}{UT\_string}} *s, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *fmt, ...) \{}
\DoxyCodeLine{161    va\_list ap;}
\DoxyCodeLine{162    va\_start(ap,fmt);}
\DoxyCodeLine{163    utstring\_printf\_va(s,fmt,ap);}
\DoxyCodeLine{164    va\_end(ap);}
\DoxyCodeLine{165 \}}
\DoxyCodeLine{166 }
\DoxyCodeLine{167 \textcolor{comment}{/*******************************************************************************}}
\DoxyCodeLine{168 \textcolor{comment}{ * begin substring search functions                                            *}}
\DoxyCodeLine{169 \textcolor{comment}{ ******************************************************************************/}}
\DoxyCodeLine{170 \textcolor{comment}{/* Build KMP table from left to right. */}}
\DoxyCodeLine{171 \mbox{\hyperlink{utstring_8h_a79ab83e6c427f21551500567eb5f143e}{UTSTRING\_UNUSED}} \textcolor{keyword}{static} \textcolor{keywordtype}{void} \_utstring\_BuildTable(}
\DoxyCodeLine{172     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *P\_Needle,}
\DoxyCodeLine{173     \textcolor{keywordtype}{size\_t} P\_NeedleLen,}
\DoxyCodeLine{174     \textcolor{keywordtype}{long} *P\_KMP\_Table)}
\DoxyCodeLine{175 \{}
\DoxyCodeLine{176     \textcolor{keywordtype}{long} i, j;}
\DoxyCodeLine{177 }
\DoxyCodeLine{178     i = 0;}
\DoxyCodeLine{179     j = i -\/ 1;}
\DoxyCodeLine{180     P\_KMP\_Table[i] = j;}
\DoxyCodeLine{181     \textcolor{keywordflow}{while} (i < (\textcolor{keywordtype}{long}) P\_NeedleLen)}
\DoxyCodeLine{182     \{}
\DoxyCodeLine{183         \textcolor{keywordflow}{while} ( (j > -\/1) \&\& (P\_Needle[i] != P\_Needle[j]) )}
\DoxyCodeLine{184         \{}
\DoxyCodeLine{185            j = P\_KMP\_Table[j];}
\DoxyCodeLine{186         \}}
\DoxyCodeLine{187         i++;}
\DoxyCodeLine{188         j++;}
\DoxyCodeLine{189         \textcolor{keywordflow}{if} (i < (\textcolor{keywordtype}{long}) P\_NeedleLen)}
\DoxyCodeLine{190         \{}
\DoxyCodeLine{191             \textcolor{keywordflow}{if} (P\_Needle[i] == P\_Needle[j])}
\DoxyCodeLine{192             \{}
\DoxyCodeLine{193                 P\_KMP\_Table[i] = P\_KMP\_Table[j];}
\DoxyCodeLine{194             \}}
\DoxyCodeLine{195             \textcolor{keywordflow}{else}}
\DoxyCodeLine{196             \{}
\DoxyCodeLine{197                 P\_KMP\_Table[i] = j;}
\DoxyCodeLine{198             \}}
\DoxyCodeLine{199         \}}
\DoxyCodeLine{200         \textcolor{keywordflow}{else}}
\DoxyCodeLine{201         \{}
\DoxyCodeLine{202             P\_KMP\_Table[i] = j;}
\DoxyCodeLine{203         \}}
\DoxyCodeLine{204     \}}
\DoxyCodeLine{205 }
\DoxyCodeLine{206     \textcolor{keywordflow}{return};}
\DoxyCodeLine{207 \}}
\DoxyCodeLine{208 }
\DoxyCodeLine{209 }
\DoxyCodeLine{210 \textcolor{comment}{/* Build KMP table from right to left. */}}
\DoxyCodeLine{211 \mbox{\hyperlink{utstring_8h_a79ab83e6c427f21551500567eb5f143e}{UTSTRING\_UNUSED}} \textcolor{keyword}{static} \textcolor{keywordtype}{void} \_utstring\_BuildTableR(}
\DoxyCodeLine{212     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *P\_Needle,}
\DoxyCodeLine{213     \textcolor{keywordtype}{size\_t} P\_NeedleLen,}
\DoxyCodeLine{214     \textcolor{keywordtype}{long} *P\_KMP\_Table)}
\DoxyCodeLine{215 \{}
\DoxyCodeLine{216     \textcolor{keywordtype}{long} i, j;}
\DoxyCodeLine{217 }
\DoxyCodeLine{218     i = P\_NeedleLen -\/ 1;}
\DoxyCodeLine{219     j = i + 1;}
\DoxyCodeLine{220     P\_KMP\_Table[i + 1] = j;}
\DoxyCodeLine{221     \textcolor{keywordflow}{while} (i >= 0)}
\DoxyCodeLine{222     \{}
\DoxyCodeLine{223         \textcolor{keywordflow}{while} ( (j < (\textcolor{keywordtype}{long}) P\_NeedleLen) \&\& (P\_Needle[i] != P\_Needle[j]) )}
\DoxyCodeLine{224         \{}
\DoxyCodeLine{225            j = P\_KMP\_Table[j + 1];}
\DoxyCodeLine{226         \}}
\DoxyCodeLine{227         i-\/-\/;}
\DoxyCodeLine{228         j-\/-\/;}
\DoxyCodeLine{229         \textcolor{keywordflow}{if} (i >= 0)}
\DoxyCodeLine{230         \{}
\DoxyCodeLine{231             \textcolor{keywordflow}{if} (P\_Needle[i] == P\_Needle[j])}
\DoxyCodeLine{232             \{}
\DoxyCodeLine{233                 P\_KMP\_Table[i + 1] = P\_KMP\_Table[j + 1];}
\DoxyCodeLine{234             \}}
\DoxyCodeLine{235             \textcolor{keywordflow}{else}}
\DoxyCodeLine{236             \{}
\DoxyCodeLine{237                 P\_KMP\_Table[i + 1] = j;}
\DoxyCodeLine{238             \}}
\DoxyCodeLine{239         \}}
\DoxyCodeLine{240         \textcolor{keywordflow}{else}}
\DoxyCodeLine{241         \{}
\DoxyCodeLine{242             P\_KMP\_Table[i + 1] = j;}
\DoxyCodeLine{243         \}}
\DoxyCodeLine{244     \}}
\DoxyCodeLine{245 }
\DoxyCodeLine{246     \textcolor{keywordflow}{return};}
\DoxyCodeLine{247 \}}
\DoxyCodeLine{248 }
\DoxyCodeLine{249 }
\DoxyCodeLine{250 \textcolor{comment}{/* Search data from left to right. ( Multiple search mode. ) */}}
\DoxyCodeLine{251 \mbox{\hyperlink{utstring_8h_a79ab83e6c427f21551500567eb5f143e}{UTSTRING\_UNUSED}} \textcolor{keyword}{static} \textcolor{keywordtype}{long} \_utstring\_find(}
\DoxyCodeLine{252     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *P\_Haystack,}
\DoxyCodeLine{253     \textcolor{keywordtype}{size\_t} P\_HaystackLen,}
\DoxyCodeLine{254     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *P\_Needle,}
\DoxyCodeLine{255     \textcolor{keywordtype}{size\_t} P\_NeedleLen,}
\DoxyCodeLine{256     \textcolor{keywordtype}{long} *P\_KMP\_Table)}
\DoxyCodeLine{257 \{}
\DoxyCodeLine{258     \textcolor{keywordtype}{long} i, j;}
\DoxyCodeLine{259     \textcolor{keywordtype}{long} V\_FindPosition = -\/1;}
\DoxyCodeLine{260 }
\DoxyCodeLine{261     \textcolor{comment}{/* Search from left to right. */}}
\DoxyCodeLine{262     i = j = 0;}
\DoxyCodeLine{263     \textcolor{keywordflow}{while} ( (j < (\textcolor{keywordtype}{int})P\_HaystackLen) \&\& (((P\_HaystackLen -\/ j) + i) >= P\_NeedleLen) )}
\DoxyCodeLine{264     \{}
\DoxyCodeLine{265         \textcolor{keywordflow}{while} ( (i > -\/1) \&\& (P\_Needle[i] != P\_Haystack[j]) )}
\DoxyCodeLine{266         \{}
\DoxyCodeLine{267             i = P\_KMP\_Table[i];}
\DoxyCodeLine{268         \}}
\DoxyCodeLine{269         i++;}
\DoxyCodeLine{270         j++;}
\DoxyCodeLine{271         \textcolor{keywordflow}{if} (i >= (\textcolor{keywordtype}{int})P\_NeedleLen)}
\DoxyCodeLine{272         \{}
\DoxyCodeLine{273             \textcolor{comment}{/* Found. */}}
\DoxyCodeLine{274             V\_FindPosition = j -\/ i;}
\DoxyCodeLine{275             \textcolor{keywordflow}{break};}
\DoxyCodeLine{276         \}}
\DoxyCodeLine{277     \}}
\DoxyCodeLine{278 }
\DoxyCodeLine{279     \textcolor{keywordflow}{return} V\_FindPosition;}
\DoxyCodeLine{280 \}}
\DoxyCodeLine{281 }
\DoxyCodeLine{282 }
\DoxyCodeLine{283 \textcolor{comment}{/* Search data from right to left. ( Multiple search mode. ) */}}
\DoxyCodeLine{284 \mbox{\hyperlink{utstring_8h_a79ab83e6c427f21551500567eb5f143e}{UTSTRING\_UNUSED}} \textcolor{keyword}{static} \textcolor{keywordtype}{long} \_utstring\_findR(}
\DoxyCodeLine{285     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *P\_Haystack,}
\DoxyCodeLine{286     \textcolor{keywordtype}{size\_t} P\_HaystackLen,}
\DoxyCodeLine{287     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *P\_Needle,}
\DoxyCodeLine{288     \textcolor{keywordtype}{size\_t} P\_NeedleLen,}
\DoxyCodeLine{289     \textcolor{keywordtype}{long} *P\_KMP\_Table)}
\DoxyCodeLine{290 \{}
\DoxyCodeLine{291     \textcolor{keywordtype}{long} i, j;}
\DoxyCodeLine{292     \textcolor{keywordtype}{long} V\_FindPosition = -\/1;}
\DoxyCodeLine{293 }
\DoxyCodeLine{294     \textcolor{comment}{/* Search from right to left. */}}
\DoxyCodeLine{295     j = (P\_HaystackLen -\/ 1);}
\DoxyCodeLine{296     i = (P\_NeedleLen -\/ 1);}
\DoxyCodeLine{297     \textcolor{keywordflow}{while} ( (j >= 0) \&\& (j >= i) )}
\DoxyCodeLine{298     \{}
\DoxyCodeLine{299         \textcolor{keywordflow}{while} ( (i < (\textcolor{keywordtype}{int})P\_NeedleLen) \&\& (P\_Needle[i] != P\_Haystack[j]) )}
\DoxyCodeLine{300         \{}
\DoxyCodeLine{301             i = P\_KMP\_Table[i + 1];}
\DoxyCodeLine{302         \}}
\DoxyCodeLine{303         i-\/-\/;}
\DoxyCodeLine{304         j-\/-\/;}
\DoxyCodeLine{305         \textcolor{keywordflow}{if} (i < 0)}
\DoxyCodeLine{306         \{}
\DoxyCodeLine{307             \textcolor{comment}{/* Found. */}}
\DoxyCodeLine{308             V\_FindPosition = j + 1;}
\DoxyCodeLine{309             \textcolor{keywordflow}{break};}
\DoxyCodeLine{310         \}}
\DoxyCodeLine{311     \}}
\DoxyCodeLine{312 }
\DoxyCodeLine{313     \textcolor{keywordflow}{return} V\_FindPosition;}
\DoxyCodeLine{314 \}}
\DoxyCodeLine{315 }
\DoxyCodeLine{316 }
\DoxyCodeLine{317 \textcolor{comment}{/* Search data from left to right. ( One time search mode. ) */}}
\DoxyCodeLine{318 \mbox{\hyperlink{utstring_8h_a79ab83e6c427f21551500567eb5f143e}{UTSTRING\_UNUSED}} \textcolor{keyword}{static} \textcolor{keywordtype}{long} utstring\_find(}
\DoxyCodeLine{319     \mbox{\hyperlink{structUT__string}{UT\_string}} *s,}
\DoxyCodeLine{320     \textcolor{keywordtype}{long} P\_StartPosition,   \textcolor{comment}{/* Start from 0. -\/1 means last position. */}}
\DoxyCodeLine{321     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *P\_Needle,}
\DoxyCodeLine{322     \textcolor{keywordtype}{size\_t} P\_NeedleLen)}
\DoxyCodeLine{323 \{}
\DoxyCodeLine{324     \textcolor{keywordtype}{long} V\_StartPosition;}
\DoxyCodeLine{325     \textcolor{keywordtype}{long} V\_HaystackLen;}
\DoxyCodeLine{326     \textcolor{keywordtype}{long} *V\_KMP\_Table;}
\DoxyCodeLine{327     \textcolor{keywordtype}{long} V\_FindPosition = -\/1;}
\DoxyCodeLine{328 }
\DoxyCodeLine{329     \textcolor{keywordflow}{if} (P\_StartPosition < 0)}
\DoxyCodeLine{330     \{}
\DoxyCodeLine{331         V\_StartPosition = s-\/>\mbox{\hyperlink{structUT__string_aa78df8b7c6db840e406431e5cb8941be}{i}} + P\_StartPosition;}
\DoxyCodeLine{332     \}}
\DoxyCodeLine{333     \textcolor{keywordflow}{else}}
\DoxyCodeLine{334     \{}
\DoxyCodeLine{335         V\_StartPosition = P\_StartPosition;}
\DoxyCodeLine{336     \}}
\DoxyCodeLine{337     V\_HaystackLen = s-\/>\mbox{\hyperlink{structUT__string_aa78df8b7c6db840e406431e5cb8941be}{i}} -\/ V\_StartPosition;}
\DoxyCodeLine{338     \textcolor{keywordflow}{if} ( (V\_HaystackLen >= (\textcolor{keywordtype}{long}) P\_NeedleLen) \&\& (P\_NeedleLen > 0) )}
\DoxyCodeLine{339     \{}
\DoxyCodeLine{340         V\_KMP\_Table = (\textcolor{keywordtype}{long} *)malloc(\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{long}) * (P\_NeedleLen + 1));}
\DoxyCodeLine{341         \textcolor{keywordflow}{if} (V\_KMP\_Table != NULL)}
\DoxyCodeLine{342         \{}
\DoxyCodeLine{343             \_utstring\_BuildTable(P\_Needle, P\_NeedleLen, V\_KMP\_Table);}
\DoxyCodeLine{344 }
\DoxyCodeLine{345             V\_FindPosition = \_utstring\_find(s-\/>\mbox{\hyperlink{structUT__string_ae8062f7fa4067676e9d74ca2b2923ff9}{d}} + V\_StartPosition,}
\DoxyCodeLine{346                                             V\_HaystackLen,}
\DoxyCodeLine{347                                             P\_Needle,}
\DoxyCodeLine{348                                             P\_NeedleLen,}
\DoxyCodeLine{349                                             V\_KMP\_Table);}
\DoxyCodeLine{350             \textcolor{keywordflow}{if} (V\_FindPosition >= 0)}
\DoxyCodeLine{351             \{}
\DoxyCodeLine{352                 V\_FindPosition += V\_StartPosition;}
\DoxyCodeLine{353             \}}
\DoxyCodeLine{354 }
\DoxyCodeLine{355             free(V\_KMP\_Table);}
\DoxyCodeLine{356         \}}
\DoxyCodeLine{357     \}}
\DoxyCodeLine{358 }
\DoxyCodeLine{359     \textcolor{keywordflow}{return} V\_FindPosition;}
\DoxyCodeLine{360 \}}
\DoxyCodeLine{361 }
\DoxyCodeLine{362 }
\DoxyCodeLine{363 \textcolor{comment}{/* Search data from right to left. ( One time search mode. ) */}}
\DoxyCodeLine{364 \mbox{\hyperlink{utstring_8h_a79ab83e6c427f21551500567eb5f143e}{UTSTRING\_UNUSED}} \textcolor{keyword}{static} \textcolor{keywordtype}{long} utstring\_findR(}
\DoxyCodeLine{365     \mbox{\hyperlink{structUT__string}{UT\_string}} *s,}
\DoxyCodeLine{366     \textcolor{keywordtype}{long} P\_StartPosition,   \textcolor{comment}{/* Start from 0. -\/1 means last position. */}}
\DoxyCodeLine{367     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *P\_Needle,}
\DoxyCodeLine{368     \textcolor{keywordtype}{size\_t} P\_NeedleLen)}
\DoxyCodeLine{369 \{}
\DoxyCodeLine{370     \textcolor{keywordtype}{long} V\_StartPosition;}
\DoxyCodeLine{371     \textcolor{keywordtype}{long} V\_HaystackLen;}
\DoxyCodeLine{372     \textcolor{keywordtype}{long} *V\_KMP\_Table;}
\DoxyCodeLine{373     \textcolor{keywordtype}{long} V\_FindPosition = -\/1;}
\DoxyCodeLine{374 }
\DoxyCodeLine{375     \textcolor{keywordflow}{if} (P\_StartPosition < 0)}
\DoxyCodeLine{376     \{}
\DoxyCodeLine{377         V\_StartPosition = s-\/>\mbox{\hyperlink{structUT__string_aa78df8b7c6db840e406431e5cb8941be}{i}} + P\_StartPosition;}
\DoxyCodeLine{378     \}}
\DoxyCodeLine{379     \textcolor{keywordflow}{else}}
\DoxyCodeLine{380     \{}
\DoxyCodeLine{381         V\_StartPosition = P\_StartPosition;}
\DoxyCodeLine{382     \}}
\DoxyCodeLine{383     V\_HaystackLen = V\_StartPosition + 1;}
\DoxyCodeLine{384     \textcolor{keywordflow}{if} ( (V\_HaystackLen >= (\textcolor{keywordtype}{long}) P\_NeedleLen) \&\& (P\_NeedleLen > 0) )}
\DoxyCodeLine{385     \{}
\DoxyCodeLine{386         V\_KMP\_Table = (\textcolor{keywordtype}{long} *)malloc(\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{long}) * (P\_NeedleLen + 1));}
\DoxyCodeLine{387         \textcolor{keywordflow}{if} (V\_KMP\_Table != NULL)}
\DoxyCodeLine{388         \{}
\DoxyCodeLine{389             \_utstring\_BuildTableR(P\_Needle, P\_NeedleLen, V\_KMP\_Table);}
\DoxyCodeLine{390 }
\DoxyCodeLine{391             V\_FindPosition = \_utstring\_findR(s-\/>\mbox{\hyperlink{structUT__string_ae8062f7fa4067676e9d74ca2b2923ff9}{d}},}
\DoxyCodeLine{392                                              V\_HaystackLen,}
\DoxyCodeLine{393                                              P\_Needle,}
\DoxyCodeLine{394                                              P\_NeedleLen,}
\DoxyCodeLine{395                                              V\_KMP\_Table);}
\DoxyCodeLine{396 }
\DoxyCodeLine{397             free(V\_KMP\_Table);}
\DoxyCodeLine{398         \}}
\DoxyCodeLine{399     \}}
\DoxyCodeLine{400 }
\DoxyCodeLine{401     \textcolor{keywordflow}{return} V\_FindPosition;}
\DoxyCodeLine{402 \}}
\DoxyCodeLine{403 \textcolor{comment}{/*******************************************************************************}}
\DoxyCodeLine{404 \textcolor{comment}{ * end substring search functions                                              *}}
\DoxyCodeLine{405 \textcolor{comment}{ ******************************************************************************/}}
\DoxyCodeLine{406 }
\DoxyCodeLine{407 \textcolor{preprocessor}{\#endif }\textcolor{comment}{/* UTSTRING\_H */}\textcolor{preprocessor}{}}

\end{DoxyCode}
